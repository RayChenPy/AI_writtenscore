<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>寫字練習智慧評測系統</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='assets/favicon.ico')}}"/>
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>
        <!-- Simple line icons-->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css" rel="stylesheet" />
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="{{ url_for('static', filename='css2/styles.css') }}" rel="stylesheet" />

        <script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js"></script>
        <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
        <link href="{{ url_for('static', filename='css/main.css') }}" rel="stylesheet">    


    </head>
    <style>
        .bg-secondary {
        background-color: #000 !important;
        }
        .masthead {
            min-height: 30rem;
            position: relative;
            display: table;
            width: 100%;
            height: auto;
            padding-top: 8rem;
            padding-bottom: 8rem;
            background: linear-gradient(
        90deg
        , rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.1) 100%), url(../static/assets/img/ghost2.jpg);
            background-position: center center;
            background-repeat: no-repeat;
            background-size: cover;
        }
        .bg-light {
            background-color: #f8f9fa !important;
            
        }
        .content-section {
            padding-top: 7.5rem;
            padding-bottom: 7.5rem;
            
        }
        #portfolio {
            /* padding-top: 7.5rem;
            padding-bottom: 7.5rem; */
            background: linear-gradient(
        rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.1) 100%), url(../static/assets/img/fileUp.jpg);
            background-position: center center;
            background-repeat: no-repeat;
            background-size: cover;
        }
        </style>
    <body id="page-top">
        <a class="menu-toggle rounded" href="#"><i class="fas fa-bars"></i></a>
        <!-- <nav id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li class="sidebar-brand"><a href="#page-top">Menu</a></li>
                <li class="sidebar-nav-item"><a href="#page-top">Home</a></li>
                <li class="sidebar-nav-item"><a href="#about">Start</a></li>
                <li class="sidebar-nav-item"><a href="#portfolio">Content</a></li>
            </ul>
        </nav> -->
        <nav class="navbar navbar-expand-lg bg-secondary text-uppercase fixed-top" id="mainNav">
            <div class="container">
                <a class="navbar-brand" style="font-weight:bold;font-size:30px;" href="#page-top">AI Demo</a>
                <button class="navbar-toggler text-uppercase font-weight-bold bg-primary text-white rounded" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded" style="font-weight:bold;font-size:30px;" href="#page-top">Home</a></li>
                        <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded" style="font-weight:bold;font-size:30px;" href="#about">Start</a></li>
                        <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded" style="font-weight:bold;font-size:30px;" href="#portfolio">Content</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Header-->
        <header class="masthead d-flex align-items-center">
            <div class="container px-4 px-lg-5 text-center">
                <h1 class="mb-1">寫字練習智慧評測系統</h1>
                <h3 class="mb-5"><em>Applying Artificial Intelligence on Vocabulary Evaluation System</em></h3>
                <a class="btn btn-primary btn-xl" href="#about">前言</a>
            </div>
        </header>
        <!-- About-->
        <section class="content-section bg-light" id="about">
            <div class="container px-4 px-lg-5 text-center">
                <div class="row gx-4 gx-lg-5 justify-content-center">
                    <div class="col-lg-10">
                        <!-- <h2>Stylish Portfolio is the perfect theme for your next project!</h2> -->
                        <p class="lead mb-5">
                            因數位教學的興起，欲抵禦這個時代的洪流，我們針對中年級的小學生設計一個，寫字練習智慧評測系統，輔助家長以及老師在小學生在此階段有更好的學習
                        </p>
                        <a class="btn btn-dark btn-xl" href="#portfolio">開始使用</a>
                    </div>
                </div>
            </div>
        </section>
        <!-- Services-->
        <!-- <section class="content-section bg-primary text-white text-center" id="services">
        </section> -->
        <!-- Portfolio-->
        <section class="content-section" id="portfolio">
            <div class="container">
                <div class="row gx-0">
                    <div class="col-lg-4">
                       
                        <h2><i class="icon-screen-smartphone"></i>檔案上傳</h2>
                            <div style="width: 100%;">
                                <form id="upload-file" method="post" enctype="multipart/form-data">
                                    <label for="imageUpload" class="upload-label">
                                        選擇檔案
                                    </label>
                                    <input type="file" name="file" id="imageUpload" accept=".png, .jpg, .jpeg">
                                    
                                </form>
                            
                                <div class="image-section" style="display:none;">
                                    <div class="img-preview">
                                        <div id="imagePreview">
                                        </div>
                                    </div>
                                    <div>
                                        <button type="button" class="btn btn-primary btn-lg " id="btn-predict">評測!</button>
                                    </div>
                                </div>
                                <div class="loader" style="display:none;"></div>
                                <br />
                                <button id="downloadButton" type="button" style="display:none;" class="btn btn-success">點我下載</button>
                            </div>
                        
                    </div>
                <div class="col-lg-4" id="teacher" style="display:none;">
                        
                         <h2><i class="icon-pencil"></i>結果</h2>
                         <img src="{{url_for('static',filename = 'result/output.jpg')}}" style="width:348px;height:450px;" id="resultImage">
                                   
                </div>
                <div class="col-lg-4" id="word" style="display:none;">
                    <div > 
                        <h2><i class="icon-like"></i>成績</h2>
                        <h4 id="result">
                            <span> </span>
                        </h4>
                       
                    </div>
                    <img src="" id="gif" width="380"/>
                </div>
            </div>
            </div>
        </section>
        <!-- src="{{url_for('static',filename = 'assets2/img/portfolio-4.jpg')}}"  -->
        <!-- Footer-->
        <footer class="footer text-center">
            <div class="container px-4 px-lg-5">
                <ul class="list-inline mb-5">
                    <li class="list-inline-item">
                        <a class="social-link rounded-circle text-white mr-3" href="https://www.facebook.com/"><i class="icon-social-facebook"></i></a>
                    </li>
                    <li class="list-inline-item">
                        <a class="social-link rounded-circle text-white mr-3" href="https://twitter.com/?lang=zh-tw"><i class="icon-social-twitter"></i></a>
                    </li>
                </ul>
                <p class="text-muted small mb-0">Copyright &copy; Your Website 2021</p>
            </div>
        </footer>
        <!-- Scroll to Top Button-->
        <a class="scroll-to-top rounded" href="#page-top"><i class="fas fa-angle-up"></i></a>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script>
            $(document).ready(function () {
                // Init
                $('.image-section').hide();
                $('.loader').hide();
                $('#result').hide();
                $('#teacher').hide();
                $('#word').hide();
                $('#downloadButton').click(function () {
                    location.href='/download';
                })
                // Upload Preview
                function readURL(input) {
                    if (input.files && input.files[0]) {
                        var reader = new FileReader();
                        reader.onload = function (e) {
                            $('#imagePreview').css('background-image', 'url(' + e.target.result + ')');
                            $('#imagePreview').hide();
                            $('#imagePreview').fadeIn(650);
                        }
                        reader.readAsDataURL(input.files[0]);
                    }
                }
                $("#imageUpload").change(function () {
                    $('.image-section').show();
                    $('#btn-predict').show();
                    $('#result').text('');
                    $('#result').hide();
                    $('#teacher').hide();
                    $('#word').hide();
                    readURL(this);
                });

                // Predict
                $('#btn-predict').click(function () {
                    var form_data = new FormData($('#upload-file')[0]);

                    // Show loading animation
                    $(this).hide();
                    $('.loader').show();

                    // Make prediction by calling api /predict
                    $.ajax({
                        type: 'POST',
                        url: '/predict',
                        data: form_data,
                        contentType: false,
                        cache: false,
                        processData: false,
                        async: true,
                        success: function (data) {
                            if(data=="辨識失敗，可能為圖片錯誤，請聯絡系統管理員"){
                                $('.loader').hide();
                                alert(data);
                            }else{
                                // Get and display the result
                                $('.loader').hide();

                                var src = $('#resultImage').attr('src')
                                d = new Date();
                                $("#resultImage").attr("src", src+'?'+d.getTime());

                                if(data.s_1=="甲上"){
                                    $("#gif").attr("src", "../static/assets/img/p1.gif");
                                }else if(data.s_1=="甲"){
                                    $("#gif").attr("src", "../static/assets/img/p2.gif");
                                } else if(data.s_1=="甲下"){
                                    $("#gif").attr("src", "../static/assets/img/p3.gif");
                                }else{
                                    $("#gif").attr("src", "../static/assets/img/p4.gif");
                                }

                                $('#teacher').show();
                                $('#word').show();

                                $('#result').fadeIn(600);
                                $('#result').html(data.s1 +'<span style="font-size:60px;">'+ data.s_1 +'</span>'
                                + '<br><font color="orange">'+ data.s2 + '</font><br><font color="red">'
                                + data.s3 + '</font><br><font color="blue">'+ data.s4+'</font><br>'+"("+data.s5+")");
                                //$('#downloadButton').show();
                                console.log('Success!');
                            }
                               
                        },
                    });
                });

            });
        </script>
        <script>
            /*!
                    * Start Bootstrap - Stylish Portfolio v6.0.1 (https://startbootstrap.com/theme/stylish-portfolio)
                    * Copyright 2013-2021 Start Bootstrap
                    * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-stylish-portfolio/blob/master/LICENSE)
                    */
                    window.addEventListener('DOMContentLoaded', event => {

                    const sidebarWrapper = document.getElementById('sidebar-wrapper');
                    let scrollToTopVisible = false;
                    // Closes the sidebar menu
                    const menuToggle = document.body.querySelector('.menu-toggle');
                    menuToggle.addEventListener('click', event => {
                        event.preventDefault();
                        sidebarWrapper.classList.toggle('active');
                        _toggleMenuIcon();
                        menuToggle.classList.toggle('active');
                    })

                    // Closes responsive menu when a scroll trigger link is clicked
                    var scrollTriggerList = [].slice.call(document.querySelectorAll('#sidebar-wrapper .js-scroll-trigger'));
                    scrollTriggerList.map(scrollTrigger => {
                        scrollTrigger.addEventListener('click', () => {
                            sidebarWrapper.classList.remove('active');
                            menuToggle.classList.remove('active');
                            _toggleMenuIcon();
                        })
                    });

                    function _toggleMenuIcon() {
                        const menuToggleBars = document.body.querySelector('.menu-toggle > .fa-bars');
                        const menuToggleTimes = document.body.querySelector('.menu-toggle > .fa-times');
                        if (menuToggleBars) {
                            menuToggleBars.classList.remove('fa-bars');
                            menuToggleBars.classList.add('fa-times');
                        }
                        if (menuToggleTimes) {
                            menuToggleTimes.classList.remove('fa-times');
                            menuToggleTimes.classList.add('fa-bars');
                        }
                    }

                    // Scroll to top button appear
                    document.addEventListener('scroll', () => {
                        const scrollToTop = document.body.querySelector('.scroll-to-top');
                        if (document.documentElement.scrollTop > 100) {
                            if (!scrollToTopVisible) {
                                fadeIn(scrollToTop);
                                scrollToTopVisible = true;
                            }
                        } else {
                            if (scrollToTopVisible) {
                                fadeOut(scrollToTop);
                                scrollToTopVisible = false;
                            }
                        }
                    })
                    })

                    function fadeOut(el) {
                    el.style.opacity = 1;
                    (function fade() {
                        if ((el.style.opacity -= .1) < 0) {
                            el.style.display = "none";
                        } else {
                            requestAnimationFrame(fade);
                        }
                    })();
                    };

                    function fadeIn(el, display) {
                    el.style.opacity = 0;
                    el.style.display = display || "block";
                    (function fade() {
                        var val = parseFloat(el.style.opacity);
                        if (!((val += .1) > 1)) {
                            el.style.opacity = val;
                            requestAnimationFrame(fade);
                        }
                    })();
                    };

        </script>
    </body>
</html>
